<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>勤務時間の確認</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }

    body {
      display: flex;
      flex-direction: column;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f5;
      color: #333;
    }

    header {
      flex: 0 0 auto;
      padding: 12px 20px;
      background: #1976d2;
      color: #fff;
      font-size: 1.1rem;
    }

    .container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: row;
      gap: 12px;
      padding: 12px;
      min-height: 0; /* flex 子要素のはみ出し防止 */
    }

    .left-panel, .right-panel {
      background: #fff;
      border-radius: 8px;
      padding: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.15);
      display: flex;
      flex-direction: column;
      min-height: 0;
    }

    .left-panel {
      flex: 3 1 0;
      gap: 12px;
    }

    .right-panel {
      flex: 2 1 0;
      max-width: 420px;
    }

    .summary-box {
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      padding: 8px 10px;
      background: #fafafa;
      font-size: 0.9rem;
    }
    .summary-box h2 {
      font-size: 1rem;
      margin: 0 0 6px 0;
    }
    .summary-grid {
      display: grid;
      grid-template-columns: 1.4fr 1fr;
      row-gap: 4px;
      column-gap: 4px;
    }
    .summary-label { color: #555; }
    .summary-value {
      font-weight: 600;
      text-align: right;
    }

    .day-detail {
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      padding: 8px 10px;
      background: #fafafa;
      font-size: 0.9rem;
      flex: 1 1 auto;          /* 左エリアを縦に広げる */
      overflow-y: auto;
    }
    .day-detail h2 {
      font-size: 1rem;
      margin: 0 0 6px 0;
    }
    .detail-row {
      display: flex;
      justify-content: space-between;
      margin: 2px 0;
    }
    .detail-label { color: #555; }
    .detail-value { font-weight: 600; }

    .warning-text {
      font-size: 0.85rem;
      color: #b26a00;
    }
    .danger-text {
      font-size: 0.85rem;
      color: #b00020;
    }

    .legal-note {
      font-size: 0.8rem;
      color: #555;
      margin-top: 8px;
    }

    /* カレンダー */
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    .calendar-header button {
      padding: 4px 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
      background: #fafafa;
      cursor: pointer;
    }
    .calendar-header button:hover { background: #eee; }

    .month-selector {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
      flex-wrap: wrap;
    }
    .month-selector button {
      padding: 4px 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
      background: #fafafa;
      cursor: pointer;
    }
    .month-selector button:hover { background: #eee; }

    .calendar-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
      table-layout: fixed;
      flex: 1 1 auto;       /* 右パネル内で縦に広げる */
    }
    .calendar-table th,
    .calendar-table td {
      text-align: center;
      padding: 4px;
      width: calc(100% / 7);
      height: 48px;
    }
    .calendar-table thead th {
      color: #ddd;
      background: #424242;
      font-weight: 500;
    }
    .calendar-table tbody td {
      background: #303030;
      color: #eee;
      border: 1px solid #424242;
      position: relative;
    }

    .calendar-cell {
      cursor: pointer;
      border-radius: 4px;
      height: 100%;
      width: 100%;
      display: flex;
      align-items: flex-start;
      justify-content: flex-end;
      padding: 4px 4px 2px 2px;
      position: relative;
    }
    .calendar-cell-empty {
      cursor: default;
      background: transparent;
    }
    .calendar-date-number {
      font-size: 0.85rem;
    }

    .cell-has-data { background: #455a64; }
    .cell-warning  { background: #fff8e1; color: #444; }
    .cell-danger   { background: #ffebee; color: #444; }

    .calendar-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #90caf9;
      position: absolute;
      left: 4px;
      bottom: 4px;
    }
    .calendar-cell-selected {
      outline: 2px solid #1976d2;
      outline-offset: -2px;
    }

    @media (max-width: 800px) {
      .container { flex-direction: column; }
      .right-panel { max-width: 100%; }
    }
  </style>
</head>
<body>
  <header>勤務時間の確認</header>

  <div class="container">
    <!-- 左パネル -->
    <div class="left-panel">
      <div class="summary-box">
        <h2 id="summaryMonthLabel">今月の集計</h2>
        <div class="summary-grid">
          <div class="summary-label">勤務日数</div>
          <div class="summary-value" id="summaryDays">0 日</div>

          <div class="summary-label">合計拘束時間</div>
          <div class="summary-value" id="summaryDuty">0 時間</div>

          <div class="summary-label">合計実労働時間</div>
          <div class="summary-value" id="summaryWork">0 時間</div>

          <div class="summary-label">平均拘束時間</div>
          <div class="summary-value" id="summaryDutyAvg">0 時間</div>

          <div class="summary-label">月の注意フラグ</div>
          <div class="summary-value" id="summaryFlags">なし</div>
        </div>
      </div>

      <div class="day-detail">
        <h2 id="detailDateLabel">日付を選択してください</h2>
        <div id="detailContent">
          カレンダーから日付をクリックすると、その日の勤務時間が表示されます。
        </div>

        <div class="legal-note">
          <strong>※運転者の労働時間に関する主な基準（要約）</strong><br />
          ・1日の拘束時間は原則13時間以内（最大15時間まで）<br />
          ・勤務終了から次の勤務開始までの休息は、原則11時間以上（最低9時間）<br />
          ・連続運転時間は4時間以内が目安、超える場合は休憩が必要<br />
          （実際の運用では、厚労省・国交省の最新ガイドラインと自社就業規則・労使協定をご確認ください）
        </div>
      </div>
    </div>

    <!-- 右パネル（カレンダー） -->
    <div class="right-panel">
      <div class="calendar-header">
        <button id="prevMonthBtn">&lt;</button>
        <div><strong id="calendarMonthLabel"></strong></div>
        <button id="nextMonthBtn">&gt;</button>
      </div>

      <div class="month-selector">
        <span>年月を指定：</span>
        <input type="month" id="monthPicker" />
        <button id="reloadBtn">読み込み</button>
      </div>

      <table class="calendar-table">
        <thead>
        <tr>
          <th>日</th><th>月</th><th>火</th><th>水</th><th>木</th><th>金</th><th>土</th>
        </tr>
        </thead>
        <tbody id="calendarBody"></tbody>
      </table>
    </div>
  </div>

  <!-- 以下、JS は前回の driver_worktime.html と同じ。省略せず貼る場合は今使っているスクリプトをそのままこの位置に入れてください -->
  <!-- （ロジック部分はいじっていないので、ここは差し替え不要です） -->
</body>
</html>
